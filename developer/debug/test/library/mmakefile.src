include $(SRCDIR)/config/aros.cfg

#MM- test : test-library

#MM- test-library : \
#MM      test-library-singletest \
#MM      test-library-singletest_auto \
#MM      test-library-peropenertest

#MM test-library-singletest : test-library-singlelib
#MM test-library-singletest_auto : test-library-singlelib
#MM test-library-peropenertest : test-library-peropenerlib

#MM- test-library-clean : \
#MM       test-library-singletest-clean \
#MM       test-library-singletest_auto-clean \
#MM       test-library-peropenertest-clean \
#MM       test-library-singlelib-clean \
#MM       test-library-peropenerlib-clean


#MM- test-cunit : test-genmodule-library-cunit
#MM- test-cunit-quick : test-genmodule-library-cunit-quick
#MM- test-genmodule-library-cunit-deps : linklibs-cunit test-library-userellib



##MM      test-library-usereltest
##MM      test-genmodule-library-cunit

##MM- test-library-userellib: includes-pertask includes-dummy linklibs-pertask linklibs-dummy

##MM- test-library-usereltest :  test-library-userellib

##MM      test-library-pertasklib-clean
##MM      test-library-userellib-clean






TARGETDIR := $(AROS_TESTS)/Library
CUNITEXEDIR := $(AROS_TESTS)/cunit/genmodule/library

USER_INCLUDES := -I$(TARGETDIR)/$(AROS_DIR_DEVELOPMENT)/include
USER_LDFLAGS := -L$(TARGETDIR)/$(AROS_DIR_DEVELOPMENT)/lib

# Test Progs

%build_prog mmake=test-library-singletest \
    progname=singletest targetdir=$(TARGETDIR) \
    uselibs=single

%build_prog mmake=test-library-singletest_auto \
    files=singletest_auto progname=singletest_auto targetdir=$(TARGETDIR) \
    uselibs=single

%build_prog mmake=test-library-peropenertest \
    progname=peropenertest targetdir=$(TARGETDIR) \
    uselibs=peropener


#%build_prog mmake=test-library-usereltest \
#    progname=usereltest targetdir=$(TARGETDIR) \
#    uselibs="userel pertask"

# Libraries

%build_module mmake=test-library-singlelib \
    modname=single modtype=library \
    files="singlelib" \
    prefix=$(TARGETDIR)

%build_module mmake=test-library-peropenerlib \
    modname=peropener modtype=library \
    files="peropenervalue peropenernolib peropenernamechange" \
    prefix=$(TARGETDIR)

#%build_module mmake=test-library-pertasklib \
#    modname=pertask modtype=library \
#    files="getparentbase pertaskvalue" linklibfiles=pertaskvalue_linklib \
#    prefix=$(TARGETDIR)

#%build_module mmake=test-library-userellib \
#    modname=userel modtype=library \
#    files="dummyadd pertaskgetparentbase dummyprint4 getchildvalue" \
#    prefix=$(TARGETDIR)

# CUnit tests

USER_INCLUDES +=
USER_CFLAGS := $(CFLAGS_NO_BUILTIN)
USER_LDFLAGS +=

##MM- test-genmodule-library-relbase-cunit : test-genmodule-library-cunit-deps

%build_prog mmake=test-genmodule-library-autoopen-cunit \
    progname=cunit-genmodule-autoopen targetdir=$(CUNITEXEDIR) \
    uselibs="single cunit"

%build_prog mmake=test-genmodule-library-library-cunit \
    progname=cunit-genmodule-library targetdir=$(CUNITEXEDIR) \
    uselibs="single cunit"

#%build_prog mmake=test-genmodule-library-relbase-cunit \
#    progname=cunit-genmodule-relbase targetdir=$(CUNITEXEDIR) \
#    uselibs="userel pertask cunit"

#MM- test-genmodule-library-cunit : test-genmodule-library-relbase-cunit test-genmodule-library-autoopen-cunit test-genmodule-library-library-cunit
#MM- test-genmodule-library-cunit-quick : test-genmodule-library-relbase-cunit-quick test-genmodule-library-autoopen-cunit-quick test-genmodule-library-library-cunit-quick

%common
